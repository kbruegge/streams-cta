<application>

<property name="folder" value="./data/raw" />
<property name="outfile" value="./data/processed/protons_training_features.csv" />

<stream id="cta:data"
        class="streams.cta.io.RecursiveDirectoryStream"
        url="file:${folder}"
        pattern="${prefix}" >

    <stream id="images" class="streams.cta.io.ImageStream"/>

</stream>


<process input="cta:data">
    <streams.cta.io.CSVWriter keys="mc:energy,source_file" url="file:${outfile}"/>
    <streams.DataRate every="1000"/>
</process>

</application>
