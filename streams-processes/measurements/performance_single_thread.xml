<application>
    
    <property name="inFolder" value="/Users/kai/kryo/" />
    <property name="resultFile" value="./performance_single_thread.json" />

    <property name="num_copies" value="1" />

    <stream id="cta:data_${copy.id}" class="streams.cta.io.RecursiveDirectoryStream"
            suffix=".kryo" url="file:${inFolder}" copies="${num_copies}" multiply="15" >
        <stream id="cta:data" class="streams.cta.io.KryoStream" limit="10000"/>
    </stream>


    <process input="cta:data_${copy.id}" copies="${num_copies}">
        <streams.DataRate every="400" logmemory="true"/>
        <streams.cta.datacorrection.BaselineShift />
        <streams.cta.extraction.Photons />
        <streams.cta.extraction.ArrivalTime />
        <streams.cta.cleaning.TwoLevelTimeNeighbor levels="400,320,120,100" />
        <streams.cta.features.Size/>
        <streams.cta.features.COG/>
        <streams.cta.features.WidthLengthDelta/>
        <Skip condition="%{data.@datarate} == null" />
            <streams.cta.io.JSONWriter url="file:${resultFile}" keys="@datarate,@freememory,@maxmemory,@totalmemory" writeblock="true"/>

    </process>


</application>