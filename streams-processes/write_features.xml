<application>


    <property name="infile" value="file:/Users/kbruegge/cta_raw_data/protons.json.gz" />

    <stream id="cta:data" class="streams.cta.io.ImageStream" url="${infile}" />

    <Queue id="flat_stream" />
    
    <process input="cta:data" copies="1">
        <streams.cta.cleaning.TailCut />
        <streams.cta.features.Moments />

        <RemoveKeys keys="telescope:*:raw*,telescope:*:shower" />

        <streams.SplitByTelescope queue="flat_stream"/>
        <streams.DataRate every="10"/>
    </process>


    <process input="flat_stream" copies="1">
        <streams.cta.io.CSVWriter keys="shower:*,*num_trigge*" url="file:protons.csv"/>
    </process>

    
</application>