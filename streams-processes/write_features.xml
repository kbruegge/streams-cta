<application>


    <property name="infile" value="otto" />

    <stream id="cta:loop" class="streams.cta.io.LoopStream" >

        <stream id="cta:data" class="streams.cta.io.ImageStream" url="file:src/main/resources/images.json.gz" />

    </stream>

    <Queue id="flat_stream" />
    
    <process input="cta:loop" copies="1">
        <!--<stream.flow.Delay time="100ms" />-->
        <streams.cta.cleaning.TailCut />
        <streams.cta.features.Moments />

        <RemoveKeys keys="telescope:*:raw*,telescope:*:shower" />

        <streams.Flatten queue="flat_stream"/>
        <streams.DataRate every="4000"/>
    </process>


    <process input="flat_stream" copies="1">
        <streams.cta.io.CSVWriter keys="shower:*,*num_trigge*" url="file:test.csv"/>
    </process>

    
</application>