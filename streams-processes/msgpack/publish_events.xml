<application>

    <property name="inFolder" value="/Users/kai/kryo/" />

    <property name="multiply" value="1" />
    <property name="port" value="5550" />


    <stream id="cta:data" class="streams.cta.io.RecursiveDirectoryStream"
            suffix=".kryo" url="file:${inFolder}" multiply="${multiply}" >
        <stream id="cta:data_in" class="streams.cta.io.KryoStream"/>
    </stream>

    <process input="cta:data">
        <streams.DataRate every="2000" />
        <streams.cta.io.msgpack.MsgPackPublisher addresses="tcp://*:${port}"/>
        <Skip condition="%{data.@datarate} == null" />
            <streams.cta.io.JSONWriter url="file:./performance_publish_msgpack.json" keys="@datarate" writeblock="true"/>
    </process>

</application>



